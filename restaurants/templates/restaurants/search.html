{% load static %}
<!DOCTYPE html>
<html lang="ru" class="bg-gradient-to-br from-indigo-500 via-purple-600 to-pink-500 min-h-screen">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>FoodMap</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = { theme: { extend: { fontFamily: { sans: ['Inter', 'sans-serif'] } } } }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;900&display=swap" rel="stylesheet">
</head>
<body class="text-white">

<div class="container mx-auto px-4 py-12 max-w-6xl">

    <h1 class="text-6xl font-black text-center mb-4 drop-shadow-lg">FoodMap</h1>
    <p class="text-2xl text-center mb-12 opacity-90">–ù–∞–π–¥–∏ —Å–≤–æ—ë –∏–¥–µ–∞–ª—å–Ω–æ–µ –±–ª—é–¥–æ –∑–∞ —Å–µ–∫—É–Ω–¥—É</p>

    <!-- –ü–æ–∏—Å–∫ -->
    <div class="flex justify-center gap-4 mb-10 flex-wrap">
        <input type="text" id="query" placeholder="–ø–∏—Ü—Ü–∞ ‚Ä¢ –ª–∞–≥–º–∞–Ω ‚Ä¢ –±—É—Ä–≥–µ—Ä ‚Ä¢ —à–∞—à–ª—ã–∫..."
               class="px-8 py-5 rounded-full text-black text-xl w-full max-w-2xl shadow-2xl focus:outline-none focus:ring-4 focus:ring-white/50">
        <button onclick="search()" class="px-10 py-5 bg-white text-purple-600 font-bold rounded-full text-xl shadow-2xl hover:bg-gray-100 transition">
            –ù–∞–π—Ç–∏
        </button>
    </div>

    <!-- –ö–Ω–æ–ø–∫–∏ CRUD -->
    <div class="flex justify-center gap-6 mb-12 flex-wrap">
        <a href="{% url 'restaurants:dish-add' %}" class="px-8 py-4 bg-white/20 backdrop-blur-lg rounded-full font-bold text-lg hover:bg-white/30 transition shadow-xl">
            + –î–æ–±–∞–≤–∏—Ç—å –±–ª—é–¥–æ
        </a>
        <a href="{% url 'restaurants:dish-list' %}" class="px-8 py-4 bg-white/20 backdrop-blur-lg rounded-full font-bold text-lg hover:bg-white/30 transition shadow-xl">
            –í—Å–µ –±–ª—é–¥–∞
        </a>
    </div>

    <!-- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã -->
    <div id="results" class="text-center text-xl">–ù–∞—á–Ω–∏ –ø–æ–∏—Å–∫...</div>
</div>

<script>
async function search() {
    const q = document.getElementById('query').value.trim();
    const div = document.getElementById('results');
    if (!q) return;

    const resp = await fetch(`/search/?q=${encodeURIComponent(q)}`);
    const dishes = await resp.json();

    div.innerHTML = dishes.length === 0 
        ? `<p class="text-3xl mt-20 opacity-80">üòî –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</p>`
        : `<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8 mt-10">
            ${dishes.map(d => `
                <div class="bg-white/10 backdrop-blur-xl rounded-3xl p-8 shadow-2xl hover:scale-105 transition transform">
                    <h3 class="text-3xl font-bold mb-3">${d.name}</h3>
                    <p class="text-xl opacity-90 mb-2">–†–µ—Å—Ç–æ—Ä–∞–Ω: <span class="font-bold">${d.restaurant}</span></p>
                    <p class="text-4xl font-black text-yellow-400 mb-6">${d.price} ‚ÇΩ</p>
                    <div class="flex flex-wrap gap-3">
                        <a href="/dishes/${d.id}/" class="px-5 py-3 bg-green-500 rounded-full font-bold hover:bg-green-400">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                        <a href="/dishes/${d.id}/edit/" class="px-5 py-3 bg-blue-500 rounded-full font-bold hover:bg-blue-400">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <a href="/dishes/${d.id}/delete/" class="px-5 py-3 bg-red-500 rounded-full font-bold hover:bg-red-400">–£–¥–∞–ª–∏—Ç—å</a>
                    </div>
                </div>
            `).join('')}
           </div>`;
}
</script>
</body>
</html>